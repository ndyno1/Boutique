<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ViralFlowr | Boutique Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
<style>
/* STYLE PREMIUM REDUIT POUR LA CLARTÃ‰ */
:root{ --primary:#2563eb; --dark:#0b1220; --bg:#f6f8fc; --line:#e6edf7; --radius:18px; }
body{ font-family:'Plus Jakarta Sans',sans-serif; background:var(--bg); color:#0f172a; margin:0; }
header{ background:white; padding:15px; border-bottom:1px solid var(--line); position:sticky; top:0; z-index:50; }
.container{ max-width:1200px; margin:0 auto; padding:20px; }
.hero-card{ background:white; border:1px solid var(--line); border-radius:24px; padding:25px; box-shadow:0 10px 30px rgba(0,0,0,0.05); margin-bottom:30px; }
.categories-nav{ display:flex; gap:10px; overflow-x:auto; padding-bottom:10px; }
.cat-btn{ flex:0 0 auto; padding:10px 20px; border-radius:50px; border:1px solid var(--line); background:white; cursor:pointer; font-weight:800; }
.cat-btn.active{ background:var(--dark); color:white; }
.grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:20px; }
.product-card{ background:white; border-radius:var(--radius); border:1px solid var(--line); padding:16px; transition:.3s; }
.product-card:hover{ transform:translateY(-5px); box-shadow:0 15px 30px rgba(0,0,0,0.1); }
.card-image{ width:60px; height:60px; border-radius:12px; margin-bottom:15px; overflow:hidden; background:#f8fafc; display:flex; align-items:center; justify-content:center; }
.card-image img{ width:100%; height:100%; object-fit:contain; }
.product-title{ font-size:16px; font-weight:800; margin:0 0 10px; }
.btn-buy{ display:block; background:var(--dark); color:white; text-align:center; padding:12px; border-radius:12px; text-decoration:none; font-weight:800; }
</style>
</head>
<body>

<header>
  <div style="display:flex; justify-content:space-between; align-items:center; max-width:1200px; margin:0 auto;">
    <div style="font-weight:900; font-size:22px;">Viral<span style="color:var(--primary)">Flowr</span></div>
    <input id="searchInput" type="text" placeholder="Rechercher..." style="padding:8px 15px; border-radius:10px; border:1px solid var(--line);">
  </div>
</header>

<div class="container">
  <div class="hero-card">
    <div class="categories-nav" id="catNav">
      <button class="cat-btn active" data-filter="all">âš¡ Tous</button>
      <button class="cat-btn" data-filter="IMEI">ðŸ“± IMEI</button>
      <button class="cat-btn" data-filter="Boost">ðŸš€ Boost</button>
      <button class="cat-btn" data-filter="Abonnement">ðŸ“º Abonnements</button>
      <button class="cat-btn" data-filter="Carte2">ðŸ’³ Cartes</button>
    </div>
  </div>

  <div id="product-grid" class="grid"></div>
</div>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbyCvuy-WiLMlAkBb7k6YyPVMk4lQhGGke05heSWSw--twKE2L-oVSOs884g3jn6lt6m/exec";
const ICONS={
  IMEI:"https://cdn-icons-png.flaticon.com/512/2544/2544574.png",
  Abonnement:"https://cdn-icons-png.flaticon.com/512/3165/3165247.png",
  default:"https://cdn-icons-png.flaticon.com/512/11520/11520110.png"
};
const FILTER_MAP = {
  "Abonnement": ["Abonnement", "Carte"],
  "Carte2": ["Carte2"],
  "Boost": ["Boost", "Boost2"]
};

let PRODUCTS = [], CURRENT_FILTER = "all", QUERY = "";

function fetchProducts(){
  const s = document.createElement('script');
  s.src = SCRIPT_URL + "?action=get_products&callback=onLoaded";
  document.body.appendChild(s);
}

function onLoaded(data){
  PRODUCTS = data;
  render();
}

function render(){
  const grid = document.getElementById('product-grid');
  const filtered = PRODUCTS.filter(p => {
    const matchCat = CURRENT_FILTER === "all" || (FILTER_MAP[CURRENT_FILTER] ? FILTER_MAP[CURRENT_FILTER].includes(p.cat) : p.cat === CURRENT_FILTER);
    const matchSearch = p.nom.toLowerCase().includes(QUERY.toLowerCase());
    return matchCat && matchSearch;
  });

  grid.innerHTML = filtered.map(p => {
    const img = p.img || ICONS[p.cat] || ICONS.default;
    return `
      <div class="product-card">
        <div class="card-image"><img src="${img}" onerror="this.src='${ICONS.default}'"></div>
        <div class="product-title">${p.nom}</div>
        <div style="font-weight:900; margin-bottom:15px;">${parseFloat(p.prix).toFixed(2)} $</div>
        <a class="btn-buy" href="paiement.html?nom=${encodeURIComponent(p.nom)}&prix=${p.prix}&cat=${p.cat}&id=${p.id}">Commander</a>
      </div>
    `;
  }).join("");
}

document.getElementById('catNav').addEventListener('click', (e) => {
  if(e.target.classList.contains('cat-btn')){
    document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
    e.target.classList.add('active');
    CURRENT_FILTER = e.target.dataset.filter;
    render();
  }
});

document.getElementById('searchInput').addEventListener('input', (e) => { QUERY = e.target.value; render(); });

fetchProducts();
</script>
</body>
</html>
